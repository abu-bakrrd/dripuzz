<!DOCTYPE html>
<html lang="{{SEO_LANGUAGE}}">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no"
		/>
		<meta name="description" content="{{SEO_DESCRIPTION}}" />
		<meta name="keywords" content="{{SEO_KEYWORDS}}" />
		<meta name="author" content="{{SHOP_NAME}}" />
		<meta name="robots" content="index, follow" />
		<meta property="og:title" content="{{SEO_TITLE}}" />
		<meta property="og:description" content="{{SEO_DESCRIPTION}}" />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="{{SEO_SITE_URL}}" />
		<meta property="og:image" content="{{SEO_SITE_URL}}/config/logo.svg" />
		<meta
			property="og:locale"
			content="{{SEO_LANGUAGE}}_{{SEO_LANGUAGE_UPPER}}"
		/>
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:title" content="{{SEO_TITLE}}" />
		<meta name="twitter:description" content="{{SEO_DESCRIPTION}}" />
		<link rel="icon" type="image/svg+xml" href="/config/logo.svg" />
		<link rel="canonical" href="{{SEO_SITE_URL}}" />
		<title>{{SEO_TITLE}}</title>
		
		<!-- Resource hints для ускорения загрузки внешних ресурсов -->
		<link rel="dns-prefetch" href="https://telegram.org" />
		<link rel="dns-prefetch" href="https://fonts.googleapis.com" />
		<link rel="dns-prefetch" href="https://fonts.gstatic.com" />
		<link rel="preconnect" href="https://telegram.org" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		
		<!-- Загружаем Telegram WebApp JS асинхронно (не блокирует рендеринг) -->
		<script src="https://telegram.org/js/telegram-web-app.js" defer></script>
		
		<!-- Загружаем шрифты асинхронно с font-display: swap для мгновенной отрисовки текста -->
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap"
			rel="stylesheet"
			media="print"
			onload="this.media='all'"
		/>
		<noscript>
			<link
				href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap"
				rel="stylesheet"
			/>
		</noscript>
		<script>
			// Apply theme and accent color immediately to prevent FOUC
			;(function () {
				const storageKey = 'vite-ui-theme'
				const theme = localStorage.getItem(storageKey) || 'light'
				const root = document.documentElement

				// Apply theme class
				if (theme === 'system') {
					const systemTheme = window.matchMedia('(prefers-color-scheme: dark)')
						.matches
						? 'dark'
						: 'light'
					root.classList.add(systemTheme)
				} else {
					root.classList.add(theme)
				}

				// Apply cached accent color (primary) if available
				try {
					const cachedConfig = localStorage.getItem('app-config')
					if (cachedConfig) {
						const config = JSON.parse(cachedConfig)
						if (config.colorScheme && config.colorScheme.primary) {
							// Convert hex to HSL for CSS variable
							const hexToHSL = hex => {
								hex = hex.replace(/^#/, '')
								const r = parseInt(hex.substring(0, 2), 16) / 255
								const g = parseInt(hex.substring(2, 4), 16) / 255
								const b = parseInt(hex.substring(4, 6), 16) / 255
								const max = Math.max(r, g, b)
								const min = Math.min(r, g, b)
								let h = 0,
									s = 0,
									l = (max + min) / 2
								if (max !== min) {
									const d = max - min
									s = l > 0.5 ? d / (2 - max - min) : d / (max + min)
									switch (max) {
										case r:
											h = ((g - b) / d + (g < b ? 6 : 0)) / 6
											break
										case g:
											h = ((b - r) / d + 2) / 6
											break
										case b:
											h = ((r - g) / d + 4) / 6
											break
									}
								}
								return `${Math.round(h * 360)} ${Math.round(
									s * 100
								)}% ${Math.round(l * 100)}%`
							}
							root.style.setProperty(
								'--primary',
								hexToHSL(config.colorScheme.primary)
							)
							if (config.colorScheme.primaryForeground) {
								root.style.setProperty(
									'--primary-foreground',
									hexToHSL(config.colorScheme.primaryForeground)
								)
							}
						}
					}
				} catch (e) {
					// Silently fail if config parsing fails
				}
			})()
		</script>
	</head>
	<body>
		<div id="root"></div>
		<script type="module" src="/src/main.tsx"></script>
	</body>
</html>
