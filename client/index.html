<!DOCTYPE html>
<html lang="{{SEO_LANGUAGE}}">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no"
		/>
		<meta name="description" content="{{SEO_DESCRIPTION}}" />
		<meta name="keywords" content="{{SEO_KEYWORDS}}" />
		<meta name="author" content="{{SHOP_NAME}}" />
		<meta name="robots" content="index, follow" />
		<meta property="og:title" content="{{SEO_TITLE}}" />
		<meta property="og:description" content="{{SEO_DESCRIPTION}}" />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="{{SEO_SITE_URL}}" />
		<meta property="og:image" content="{{SEO_SITE_URL}}/config/logo.svg" />
		<meta
			property="og:locale"
			content="{{SEO_LANGUAGE}}_{{SEO_LANGUAGE_UPPER}}"
		/>
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content="{{SEO_TITLE}}" />
		<meta name="twitter:description" content="{{SEO_DESCRIPTION}}" />
		<meta name="twitter:image" content="{{SEO_SITE_URL}}/config/logo.svg" />

		<!-- Favicons -->
		<link rel="icon" type="image/svg+xml" href="/config/logo.svg" />
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<link rel="apple-touch-icon" href="/config/logo.svg" />

		<!-- Google Search specific -->
		<meta name="google" content="notranslate" />

		<link rel="canonical" href="{{SEO_SITE_URL}}" />
		<title>{{SEO_TITLE}}</title>

		<!-- Resource hints для ускорения загрузки внешних ресурсов -->
		<link rel="dns-prefetch" href="https://fonts.googleapis.com" />
		<link rel="dns-prefetch" href="https://fonts.gstatic.com" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

		<!-- Загружаем шрифты асинхронно с font-display: swap для мгновенной отрисовки текста -->
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap"
			rel="stylesheet"
			media="print"
			onload="this.media='all'"
		/>
		<noscript>
			<link
				href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap"
				rel="stylesheet"
			/>
		</noscript>
		<style>
			/* ЖЕЛЕЗОБЕТОННОЕ правило для отключения transitions у Radix UI элементов */
			[data-radix-dropdown-menu-content],
			[data-radix-select-content],
			[data-radix-dropdown-menu-content] *,
			[data-radix-select-content] *,
			[data-radix-dropdown-menu-content] *::before,
			[data-radix-select-content] *::before,
			[data-radix-dropdown-menu-content] *::after,
			[data-radix-select-content] *::after,
			[data-radix-portal] [role='menu'],
			[data-radix-portal] [role='listbox'],
			[data-radix-portal] [role='menu'] *,
			[data-radix-portal] [role='listbox'] *,
			[data-radix-portal] [role='menu'] *::before,
			[data-radix-portal] [role='listbox'] *::before,
			[data-radix-portal] [role='menu'] *::after,
			[data-radix-portal] [role='listbox'] *::after {
				transition: none !important;
				transition-property: none !important;
				transition-duration: 0s !important;
				transition-delay: 0s !important;
				transition-timing-function: none !important;
				animation: none !important;
				animation-duration: 0s !important;
				transform: none !important;
			}

			/* УЛЬТИМАТУМ: Мгновенная смена темы - отключаем transitions для ВСЕХ цветов */
			/* Применяем ПЕРВЫМ для максимального приоритета */
			html body *:not(:hover):not(:focus):not(:active),
			html body *:not(:hover):not(:focus):not(:active)::before,
			html body *:not(:hover):not(:focus):not(:active)::after {
				transition-property: transform, filter, opacity !important;
			}

			/* Переопределяем transition-colors классы */
			html body .transition-colors:not(:hover):not(:focus):not(:active),
			html
				body
				[class*='transition-colors']:not(:hover):not(:focus):not(:active) {
				transition-property: transform, filter, opacity !important;
			}

			/* Переопределяем transition-all классы */
			html body .transition-all:not(:hover):not(:focus):not(:active),
			html body [class*='transition-all']:not(:hover):not(:focus):not(:active) {
				transition-property: transform, filter, opacity !important;
			}

			/* Для SVG отключаем fill и stroke */
			html body svg:not(:hover):not(:focus):not(:active),
			html body svg *:not(:hover):not(:focus):not(:active) {
				transition-property: transform, filter, opacity !important;
			}
		</style>
		<script>
			// Принудительно применяем transition: none к Radix UI элементам
			;(function () {
				function forceNoTransition() {
					const selectors = [
						'[data-radix-dropdown-menu-content]',
						'[data-radix-select-content]',
						'[data-radix-portal] [role="menu"]',
						'[data-radix-portal] [role="listbox"]',
					]

					selectors.forEach(selector => {
						const elements = document.querySelectorAll(selector)
						elements.forEach(el => {
							// Применяем через setProperty с important
							el.style.setProperty('transition', 'none', 'important')
							el.style.setProperty('transition-property', 'none', 'important')
							el.style.setProperty('transition-duration', '0s', 'important')
							el.style.setProperty('transition-delay', '0s', 'important')
							el.style.setProperty(
								'transition-timing-function',
								'none',
								'important'
							)
							el.style.setProperty('animation', 'none', 'important')
							el.style.setProperty('animation-duration', '0s', 'important')
							el.style.setProperty('transform', 'none', 'important')

							// Применяем к дочерним элементам
							const children = el.querySelectorAll('*')
							children.forEach(child => {
								child.style.setProperty('transition', 'none', 'important')
								child.style.setProperty(
									'transition-property',
									'none',
									'important'
								)
								child.style.setProperty(
									'transition-duration',
									'0s',
									'important'
								)
								child.style.setProperty('transition-delay', '0s', 'important')
								child.style.setProperty('animation', 'none', 'important')
							})
						})
					})
				}

				// Применяем сразу
				forceNoTransition()

				// Используем requestAnimationFrame для постоянного применения
				function rafLoop() {
					forceNoTransition()
					requestAnimationFrame(rafLoop)
				}
				requestAnimationFrame(rafLoop)

				// Следим за появлением новых элементов и изменениями атрибутов
				const observer = new MutationObserver(mutations => {
					forceNoTransition()
					// Также применяем при изменении data-state (открытие/закрытие)
					mutations.forEach(mutation => {
						if (
							mutation.type === 'attributes' &&
							(mutation.attributeName === 'data-state' ||
								mutation.attributeName === 'style')
						) {
							forceNoTransition()
						}
					})
				})

				// Начинаем наблюдение после загрузки DOM
				function startObserving() {
					observer.observe(document.body, {
						childList: true,
						subtree: true,
						attributes: true,
						attributeFilter: ['data-state', 'style', 'class'],
					})
					forceNoTransition()
				}

				if (document.readyState === 'loading') {
					document.addEventListener('DOMContentLoaded', startObserving)
				} else {
					startObserving()
				}

				// Обработчики событий на клики и открытие меню
				document.addEventListener(
					'click',
					() => {
						setTimeout(forceNoTransition, 0)
						setTimeout(forceNoTransition, 10)
						setTimeout(forceNoTransition, 50)
					},
					true
				)

				// Перехватываем изменения стилей через Proxy (если возможно)
				if (window.CSS && CSS.supports && CSS.supports('transition', 'none')) {
					const originalSetProperty = CSSStyleDeclaration.prototype.setProperty
					CSSStyleDeclaration.prototype.setProperty = function (
						property,
						value,
						priority
					) {
						const el = this
						if (el && el.parentElement) {
							const isRadixElement = el.closest(
								'[data-radix-dropdown-menu-content], [data-radix-select-content], [data-radix-portal] [role="menu"], [data-radix-portal] [role="listbox"]'
							)
							if (
								isRadixElement &&
								(property === 'transition' ||
									property === 'transition-property' ||
									property === 'transition-duration')
							) {
								return // Блокируем установку transition для Radix элементов
							}
						}
						return originalSetProperty.call(this, property, value, priority)
					}
				}
			})()

			// Apply theme and accent color immediately to prevent FOUC
			;(function () {
				const storageKey = 'vite-ui-theme'
				const theme = localStorage.getItem(storageKey) || 'light'
				const root = document.documentElement

				// Apply theme class
				if (theme === 'system') {
					const systemTheme = window.matchMedia('(prefers-color-scheme: dark)')
						.matches
						? 'dark'
						: 'light'
					root.classList.add(systemTheme)
				} else {
					root.classList.add(theme)
				}

				// Apply cached accent color (primary) if available
				try {
					const cachedConfig = localStorage.getItem('app-config')
					if (cachedConfig) {
						const config = JSON.parse(cachedConfig)
						if (config.colorScheme && config.colorScheme.primary) {
							// Convert hex to HSL for CSS variable
							const hexToHSL = hex => {
								hex = hex.replace(/^#/, '')
								const r = parseInt(hex.substring(0, 2), 16) / 255
								const g = parseInt(hex.substring(2, 4), 16) / 255
								const b = parseInt(hex.substring(4, 6), 16) / 255
								const max = Math.max(r, g, b)
								const min = Math.min(r, g, b)
								let h = 0,
									s = 0,
									l = (max + min) / 2
								if (max !== min) {
									const d = max - min
									s = l > 0.5 ? d / (2 - max - min) : d / (max + min)
									switch (max) {
										case r:
											h = ((g - b) / d + (g < b ? 6 : 0)) / 6
											break
										case g:
											h = ((b - r) / d + 2) / 6
											break
										case b:
											h = ((r - g) / d + 4) / 6
											break
									}
								}
								return `${Math.round(h * 360)} ${Math.round(
									s * 100
								)}% ${Math.round(l * 100)}%`
							}
							root.style.setProperty(
								'--primary',
								hexToHSL(config.colorScheme.primary)
							)
							if (config.colorScheme.primaryForeground) {
								root.style.setProperty(
									'--primary-foreground',
									hexToHSL(config.colorScheme.primaryForeground)
								)
							}
						}
					}
				} catch (e) {
					// Silently fail if config parsing fails
				}
			})()
		</script>
	</head>
	<body>
		<div id="root"></div>
		<script type="module" src="/src/main.tsx"></script>
	</body>
</html>
